(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{205:function(e,t,a){},212:function(e,t,a){},213:function(e,t,a){},214:function(e,t,a){"use strict";a.r(t);var n,r=a(0),o=a.n(r),c=a(7),l=a.n(c),s=(a(84),a(14)),i=a.n(s),u=a(23),m=a(5),b=a(221),d=a(217),f=a(218),g=a(71),p=a(25),h=a.n(p),v=a(222),y=a(219),E=a(220),O=(a(91),a(35)),C=a.n(O),j={name:"Mr. Mysterious",event:"???"},w=function(e){var t=e.countries,a=e.player,n=e.balance;return o.a.createElement(d.a,{noGutters:!0},o.a.createElement(f.a,{xs:10,className:"player-name"},o.a.createElement(v.a,{key:a.name,placement:"right",overlay:o.a.createElement(y.a,{id:"tt-".concat(a.name)},(t.get(a.countryId)||{name:"unknown country"}).name)},o.a.createElement(E.a,{pill:!0,style:{backgroundColor:(t.get(a.countryId)||{color:"white"}).color,color:"#eee"}},"".concat((t.get(a.countryId)||{event:"ext"}).event,"-").concat((t.get(a.countryId)||{shortName:"xxx"}).shortName.toLowerCase())))," ".concat(a.name||"Mr. Anonymous")),o.a.createElement(f.a,null,C()(n).format("0a")))},x=o.a.memo(function(e){return o.a.createElement("div",{className:"leaderboard"},o.a.createElement("h4",null,"Best planters - CO\u2082 locked"),o.a.createElement(d.a,{className:"tree-huggers",noGutters:!0},o.a.createElement(f.a,null,o.a.createElement(d.a,{className:"headers",noGutters:!0},o.a.createElement(f.a,{xs:10},"name"),o.a.createElement(f.a,null,"CO\u2082 (Mt)")),e.trees.slice(0,10).map(function(t){return o.a.createElement(w,{key:t[0],countries:e.countries,player:e.players[t[0]]||j,balance:parseInt(t[1],10)})}))),o.a.createElement("h4",null,"Biggest polluters - CO\u2082 emitted"),o.a.createElement(d.a,{className:"polluters",noGutters:!0},o.a.createElement(f.a,null,o.a.createElement(d.a,{className:"headers",noGutters:!0},o.a.createElement(f.a,{xs:10},"name"),o.a.createElement(f.a,null,"CO\u2082 (Mt)")),e.emissions.slice(0,10).map(function(t){return o.a.createElement(w,{key:t[0],countries:e.countries,player:e.players[t[0]]||j,balance:parseInt(t[1],10)})}))))}),k=a(19),N=(a(205),a(206),a(78)),S=N,A={Accept:"application/json","Content-Type":"application/json"},M=function(){var e=Object(u.a)(i.a.mark(function e(t){var a,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:if(200!==(a=e.sent).status){e.next=8;break}return e.next=6,a.json();case 6:return n=e.sent,e.abrupt("return",n);case 8:return e.abrupt("return",void 0);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(u.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(function(){return e="/stats".concat(n?"?from=".concat(n):""),fetch("".concat("https://planet-a-backend.before.coffee").concat(e),{method:"GET",headers:A});var e});case 2:return(t=e.sent)&&(n=t.lastUpdate),e.abrupt("return",t);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),T=k.c.global;T.elements.point.backgroundColor="rgba(255, 255, 255, 0.8)",T.elements.point.borderColor="rgba(255, 255, 255, 0.8)",T.elements.line.borderColor="rgba(255, 255, 255, 0.8)",T.legend.labels.fontColor="rgba(255, 255, 255, 0.8)";var I=o.a.memo(function(e){var t=Array.from(e.countries.keys()),a=Object(r.useState)([]),n=Object(m.a)(a,2),c=n[0],l=n[1],s=Object(r.useState)(new Map),i=Object(m.a)(s,2),u=i[0],b=i[1],g=Object(r.useState)(3e3),p=Object(m.a)(g,2),h=p[0],v=p[1];return Object(r.useEffect)(function(){var a=e.netCO2History,n={};Object.entries(a).forEach(function(e){var t=Object(m.a)(e,2),a=t[0];t[1].forEach(function(e){var t=n[e[1]]||{};t[a]=parseInt(e[0],10),n[e[1]]=t})});var r=Object.keys(n).sort(),o=c.reduce(function(e,t){return e[(t.getTime()/1e3).toString()]=!0,e},{}),s=new Map,i=!0,d=!1,f=void 0;try{for(var g,p=e.countries.keys()[Symbol.iterator]();!(i=(g=p.next()).done);i=!0){var h=g.value;s.set(h,u.get(h)||[])}}catch(E){d=!0,f=E}finally{try{i||null==p.return||p.return()}finally{if(d)throw f}}r.forEach(function(e){o[e]=!0,t.forEach(function(t){var a=s.get(t)||[],r=n[e][t];if(!r){var o=(a.length&&a||[0]).slice(-1);r=Object(m.a)(o,1)[0]}a.push(r)})});var y=Array.from(s.values()).reduce(function(e,t){var a=t.slice(-1);return e+Object(m.a)(a,1)[0]},3e3);l(Object.keys(o).sort().map(function(e){return new Date(1e3*parseInt(e,10))})),b(s),v(y)},[e.netCO2History]),o.a.createElement(o.a.Fragment,null,o.a.createElement("h4",null,"Global emissions"),o.a.createElement(d.a,{className:"global-stats",noGutters:!0},o.a.createElement(f.a,null,o.a.createElement(d.a,null,o.a.createElement(f.a,null,o.a.createElement(k.b,{data:{labels:c,datasets:Array.from(u.entries()).map(function(e,t){var a=Object(m.a)(e,2),n=a[0],r=a[1];return{label:S[n].name,fill:0===t?"origin":void 0,data:r,pointBorderWidth:0,backgroundColor:D[n]}})},options:{animation:{duration:0},showLine:!0,spanGaps:!0,elements:{line:{fill:"-1"}},scales:{xAxes:[{id:"time-axis",type:"time",display:!0,gridLines:{display:!1,color:"rgba(255, 255, 255, 0.6)"},ticks:{source:"auto",beginAtZero:!1,autoSkip:!0,fontColor:"rgba(255, 255, 255, 0.8)"},scaleLabel:"rgba(255, 255, 255, 0.8)",time:{unit:"second",round:"second"}}],yAxes:[{id:"value-axis",type:"linear",scaleLabel:"rgba(255, 255, 255, 0.8)",stacked:!0,gridLines:{color:"rgba(255, 255, 255, 0.2)"},ticks:{suggestedMax:43e5,suggestedMin:0,beginAtZero:!0,fontColor:"rgba(255, 255, 255, 0.8)"}}]},annotation:{drawTime:"afterDraw",annotations:[{type:"line",mode:"horizontal",scaleID:"value-axis",value:342e4,borderColor:"rgba(253, 106, 2, 0.7)",borderWidth:2,label:{content:"+1.5\xb0C",enabled:!0,backgroundColor:"rgba(253, 106, 2, 0.8)"}},{type:"line",mode:"horizontal",scaleID:"value-axis",value:417e4,borderColor:"red",borderWidth:1,label:{content:"+2\xb0C",enabled:!0,backgroundColor:"rgba(255, 0, 0, 0.7)"}}]}},width:300,height:400,redraw:!0}))),o.a.createElement(d.a,{className:"current"},o.a.createElement(f.a,null,"Current CO\u2082 levels: ",o.a.createElement("span",{className:"bold"},h||0)," ","Mt")),o.a.createElement(d.a,{className:"goe"},"G\xf6llars circulating:","  ",o.a.createElement("span",{className:"bold"},"\u20b2",C()(e.goeMillis/1e3).format("0.00"))))))}),G=(a(212),o.a.memo(function(e){var t=e.countries,a=e.co2ByCountry,n=e.treesByCountry,r=Array.from(t.keys()),c=[],l=[],s=[];return t.forEach(function(e,t){c.push(e.shortName),l.push(parseInt(a[t]||"0",10)),s.push(parseInt(n[t]||"0",10))}),o.a.createElement(o.a.Fragment,null,o.a.createElement("h4",null,"CO\u2082 emitted"),o.a.createElement(d.a,{className:"sustainability",noGutters:!0},o.a.createElement(f.a,null,o.a.createElement(k.a,{data:{labels:c,datasets:[{label:"CO\u2082",data:l,backgroundColor:r.map(function(e){return D[e]})}]},options:{animation:{duration:0},legend:{display:!1},scales:{xAxes:[{barPercentage:.5,scaleLabel:"rgba(255, 255, 255, 0.8)",gridLines:{color:"rgba(255, 255, 255, 0.4)"},ticks:{fontSize:16,fontColor:"rgba(255, 255, 255, 0.8)"}}],yAxes:[{scaleLabel:"rgba(255, 255, 255, 0.8)",gridLines:{color:"rgba(255, 255, 255, 0.2)"},ticks:{suggestedMin:5e5,fontColor:"rgba(255, 255, 255, 0.8)"}}]}},width:200,height:120,redraw:!0}))),o.a.createElement("h4",null,"Trees planted"),o.a.createElement(d.a,{className:"trees",noGutters:!0},o.a.createElement(f.a,null,o.a.createElement(k.a,{data:{labels:c,datasets:[{label:"trees",data:s,backgroundColor:r.map(function(e){return D[e]})}]},options:{animation:{duration:0},legend:{display:!1},scales:{xAxes:[{barPercentage:.5,scaleLabel:"rgba(255, 255, 255, 0.8)",gridLines:{color:"rgba(255, 255, 255, 0.4)"},ticks:{fontSize:16,fontColor:"rgba(255, 255, 255, 0.8)"}}],yAxes:[{scaleLabel:"rgba(255, 255, 255, 0.8)",gridLines:{color:"rgba(255, 255, 255, 0.2)"},ticks:{suggestedMin:0,fontColor:"rgba(255, 255, 255, 0.8)"}}]}},width:200,height:120,redraw:!0}))))})),B=(a(213),new Map(Object.entries(S).sort(function(e,t){var a=Object(m.a)(e,2),n=(a[0],a[1]),r=Object(m.a)(t,2),o=(r[0],r[1]);return n.event>o.event?1:n.event===o.event?n.shortName>o.shortName?1:n.shortName===o.shortName?0:-1:-1}))),D=Array.from(B.values()).reduce(function(e,t){return e[t.id]=t.pattern?Object(g.draw)(t.pattern,t.color):t.color,e},{}),H=function(e){return o.a.createElement("div",null)},P=function(){var e=Object(r.useState)({}),t=Object(m.a)(e,2),a=t[0],n=t[1],c=Object(r.useState)([]),l=Object(m.a)(c,2),s=l[0],g=l[1],v=Object(r.useState)([]),y=Object(m.a)(v,2),E=y[0],O=y[1],C=Object(r.useState)(Object.keys(B).reduce(function(e,t){return e[t]=[],e},{})),j=Object(m.a)(C,2),w=j[0],k=j[1],N=Object(r.useState)({}),S=Object(m.a)(N,2),A=S[0],M=S[1],T=Object(r.useState)({}),D=Object(m.a)(T,2),P=D[0],R=D[1],W=Object(r.useState)(0),z=Object(m.a)(W,2),F=z[0],J=z[1],U=Object(r.useRef)(new Date("1984-02-24T15:54:00")),Z=Object(r.useState)(p.STATS.init),K=Object(m.a)(Z,2),$=K[0],q=K[1],Q=Object(r.useState)(!1),V=Object(m.a)(Q,2),X=(V[0],V[1],function(){var e=Object(u.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:t=e.sent,U.current&&U.current.setTime((new Date).valueOf()),t&&(n(t.players),g(t.trees),O(t.emissions),k(t.netCO2History),M(t.co2ByCountry),R(t.treesByCountry),J(t.goeMillisCirculating));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}());Object(r.useEffect)(function(){X();var e=function(){"visible"===document.visibilityState&&U.current&&(new Date).valueOf()-U.current.valueOf()>15e3&&(console.log("polling after getting back focus, lastUpdate was on ".concat(U)),X())};return document.addEventListener("visibilitychange",e),function(){return document.removeEventListener("visibilitychange",e)}},[]),function(e,t){var a=Object(r.useRef)();Object(r.useEffect)(function(){a.current=e},[e]),Object(r.useEffect)(function(){if(null!==t){var e=setInterval(function(){a.current()},t);return function(){return clearInterval(e)}}},[t])}(X,15e3);return o.a.createElement("div",{className:"app"},o.a.createElement(h.a,{downEnough:100,action:$,handleAction:function(e){if(e!==$)if(e===p.STATS.refreshing){var t=function(){q(p.STATS.refreshed)};X().then(t).catch(t)}else q(e)},hasMore:!1,FooterNode:H},o.a.createElement(b.a,{fluid:!0},o.a.createElement(d.a,null,o.a.createElement(f.a,null,o.a.createElement("h1",null,o.a.createElement("span",{role:"img","aria-label":"globe"},"\ud83c\udf0d")," ","Planet A"," ",o.a.createElement("span",{role:"img","aria-label":"globe"},"\ud83c\udf33")))," "),o.a.createElement(d.a,null,o.a.createElement(f.a,{className:"mainCol",sm:12,lg:6,xl:4},o.a.createElement(x,{countries:B,players:a,trees:s,emissions:E})),o.a.createElement(f.a,{className:"mainCol",sm:12,lg:6,xl:4},o.a.createElement(I,{countries:B,netCO2History:w,goeMillis:F})),o.a.createElement(f.a,{className:"mainCol",sm:12,lg:6,xl:4},o.a.createElement(G,{countries:B,co2ByCountry:A,treesByCountry:P}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},78:function(e){e.exports={49160:{id:"49160",name:"Pollutistan",shortName:"PLAN",color:"rgba(0, 0, 255, 0.5)",textColor:"#000065",event:"eth2"},49161:{id:"49161",name:"New Smogland",shortName:"SMOG",color:"rgba(154, 186, 0, 0.6)",textColor:"#5b7500",event:"ccc"},49162:{id:"49162",name:"Democratic Repulic of Deforestation",shortName:"DRED",color:"rgba(255, 198, 0, 0.55)",textColor:"#9d6d1d",pattern:"dot",event:"ccc"},49163:{id:"49163",name:"Cataclysmia",shortName:"CASM",color:"rgba(1, 118, 187, 0.45)",pattern:"dash",textColor:"#01436c",event:"ccc"},49164:{id:"49164",name:"Tornayda",shortName:"TORN",color:"rgba(255, 210, 0, 0.6)",textColor:"#876224",event:"eth2"},49165:{id:"49165",name:"Kingdom of Heatwave",shortName:"HEAT",color:"rgba(255, 0, 0, 0.5)",textColor:"#750000",event:"eth2"}}},79:function(e,t,a){e.exports=a(214)},84:function(e,t,a){},91:function(e,t,a){}},[[79,1,2]]]);
//# sourceMappingURL=main.dadd2c36.chunk.js.map